<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link rel="icon" href="https://www.adobe.com/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="https://www.adobe.com/favicon.ico" type="image/x-icon">
    <title>Adobe: Advertising Preview Page</title>
    <!-- <link rel="icon" href="favicon-16x16.ico" type="image/x-icon"> -->
    <link rel="icon" href="favicon-32x32.ico" type="image/x-icon">
    <style media="screen">
      body {
        min-width: 1024px;
        margin-bottom: 0px;
      }
      .ad-wrapper {
        /* max-width: 970px; */
        margin: 0 auto;
        text-align: center;
      }
      #headerContainer, #header, #subheader{
        text-align: center;
      }
      #header .image-container {
        display: inline-block;
        position: relative;
      }
      #header .image {
        position: relative;
        display: inline-block;
        width: 50px;
        height: 40px;
      }
      #header .image:first-child {
        position: absolute;
        top:0px;
        left:0px;
      }
      #header .image img {
        max-width: 100%;
        max-height: 100%;
      }

      #header > div {
        font-family: Arial;
        display: inline-block;
        /* min-height: 65px; */
        vertical-align: top;
        padding: 10px 5px 2px 5px;
        margin: 0px 5px 2px 5px;
        color:#333;
        text-align: center;
        /* -webkit-transition: all ease-out 0.2s;
        transition: all ease-out 0.2s; */
        cursor: pointer;
      }
      #header > div:hover {
        margin: 0px;
        margin: 0px 5px 0px 5px;
        border-bottom: 2px solid;
        color:#0084d6;
      }
      #header > div.selected {
        margin: 0px;
        margin: 0px 5px 0px 5px;
        border-bottom: 2px solid;
        color:#0084d6;
      }
      #subheader {
        display: inline-block;
        margin: 0 20px;
        background-color: rgba(0,0,0,0.1);
      }
      #subheader > div {
        font-family: Arial;
        display: inline-block;
        /* min-height: 65px; */
        vertical-align: top;
        font-size: 12px;
        padding: 10px 5px 2px 5px;
        margin: 0px 5px 8px 5px;
        color:#333;
        text-align: center;
        /* -webkit-transition: all ease-out 0.2s;
        transition: all ease-out 0.2s; */
        cursor: pointer;
      }
      #subheader > div:hover {
        /* margin: 0px;
        margin: 0px 5px 0px 5px;
        border-bottom: 2px solid; */
        color:#0084d6;
      }
      #subheader > div.selected {
        /* margin: 0px;
        margin: 0px 5px 0px 5px;
        border-bottom: 2px solid; */
        color:#0084d6;
      }
      #subsubheader {
        /* display: inline-block; */
        margin: 10px 20px 0;
        /* background-color: rgba(0,0,0,0.1); */
      }
      #subsubheader > div {
        font-family: Arial;
        display: inline-block;
        /* min-height: 65px; */
        vertical-align: top;
        font-size: 14px;
        padding: 2px 7px;
        margin: 0px 5px;
        color:#333;
        border: 1px solid;
        border-radius: 15px;
        text-align: center;
        /* -webkit-transition: all ease-out 0.2s;
        transition: all ease-out 0.2s; */
        cursor: pointer;
      }
      #subsubheader > div:hover {
        /* margin: 0px;
        margin: 0px 5px 0px 5px;
        border-bottom: 2px solid; */
        color:#0084d6;
        border-bottom: 2px solid;
      }
      #subsubheader > div.selected {
        /* margin: 0px;
        margin: 0px 5px 0px 5px;
        border-bottom: 2px solid; */
        color:#0084d6;
        border-bottom: 2px solid;
      }
      #title {
        font-family: Arial;
        /* display: inline-block; */
        vertical-align: top;
        padding: 10px 5px 2px 5px;
        margin: 0px 5px 2px 5px;
        color:#333;
        font-size: 20px;
        text-align: center;
        color:#0084d6;
      }
      .frame-title{
        font-family: Arial;
        /* display: inline-block; */
        vertical-align: top;
        padding: 10px 5px 2px 5px;
        margin: 0px 5px 2px 5px;
        color:#333;
        font-size: 20px;
        text-align: center;
        color:#0084d6;
        margin-top: 10px;
        border-bottom: 1px solid #0084d6;
      }
      .frame-wrapper {
        display: inline-block;
      }
      .frame-wrapper div {
        font-family: Arial;
        text-align: left;
        margin-left: 10px;
      }
      iframe {
        border: none;
        margin: 10px 10px 2px 10px;
      }
      @font-face {
        font-family:"adobe-clean";
        src:url("fonts/adobe-clean-700.woff2") format("woff2"),
          url("fonts/adobe-clean-700.woff") format("woff"),
          url("fonts/adobe-clean-700.otf") format("opentype");
        font-display:auto;font-style:normal;font-weight:700;
      }
      footer {
        position: fixed;
        left: 0;
        bottom: 0;
        right: 0;
        background: #fff;
        font-family:adobe-clean,Source Sans Pro,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;
        font-weight: 700;
        color: #4B4B4B;
        border-top: solid 1px #999999;
        display: flex;
        justify-content: center;/*space-between;*/
        padding: 6px 10px 8px;
        margin: 20px 20px 0px;
      }
      .adobe-red { color: #FA0F00; }
    </style>
    <script src="js/AMOLibrary.js" charset="utf-8"></script>
    <script src="js/content.js" charset="utf-8"></script>
    <script src="frames.js" charset="utf-8"></script>
  </head>
  <body onload="init()">
    <div id="headerContainer">
      <div id="header" class=""></div>
      <div id="subheader" class=""></div>
      <div id="subsubheader" class=""></div>
      <div id="title" class=""></div>
    </div>
    <div id="adContainer" class="ad-wrapper"></div>
    <footer>
      <!-- <div style="font-size: 14px;">Content: <a id="contentLink" href="https://adobe.com" target="_blank" style="text-decoration:none;"><img src="images/sheets-icon.svg" style="height: 14px;margin: 0px 4px;vertical-align:-5%;" /></a></div> -->
      <div style="font-size: 14px;">Developed by: <a href="https://adobe.com" target="_blank" style="text-decoration:none;"><img src="images/Adobe_Corporate_Horizontal_Red_HEX.svg" style="width: 14px;margin: 0px 4px;vertical-align:-5%;" /><font class="adobe-red" style="font-size:14px;">Adobe</font></a></div>
    </footer>
    <script type="text/javascript">
    function init() {
      // document.querySelector('#contentLink').href = "https://docs.google.com/spreadsheets/d/" + sheetID.split('/')[0];
    }
    var checkFooter = function() {
      var bodyHeight = document.body.offsetHeight;
      var footer = document.querySelector('footer');
      if(window.innerHeight > bodyHeight) {
        footer.style.position = 'fixed';
        document.body.style.paddingBottom = '30px';
      } else {
        footer.style.position = 'static';
        document.body.style.paddingBottom = '0px';
      }
    }
    checkFooter();
    window.onresize = checkFooter;
      var bannerData = [], bannerData1 = [], feedData2 = [];
      // var getCAMData = function(data) {
      //     var templates = {
      //       'Template 1': `var cam = {
      //         layout: data.Layout,
      //         headline1: data.headline1,
      //         headline2: data.headline2,
      //         costline3: data.costline3,
      //         costline1: data.costline1,
      //         costline2: data.costline2,
      //         ctaText: data.CTA,
      //         impressionTracker: "../../../../1x1.png?impressionTracker=" + Math.random(),
      //         clickTracker: "../../../../1x1.png?clickTracker=" + Math.random(),
      //         clickUrl: "https://office.com/",
      //       }`,
      //       'Template 2': `var cam = {
      //         layout: data.Layout,
      //         headline1: data.headline1,
      //         headline2: data.headline2,
      //         costline3: data.costline3,
      //         costline1: data.costline1,
      //         costline2: data.costline2,
      //         ctaText: data.CTA,
      //         impressionTracker: "../../../../1x1.png?impressionTracker=" + Math.random(),
      //         clickTracker: "../../../../1x1.png?clickTracker=" + Math.random(),
      //         clickUrl: "https://office.com/",
      //       }`,
      //       'Template 3': `var cam = {
      //         layout: data.Layout,
      //         headline1: data.headline1,
      //         headline2: data.headline2,
      //         headline3: data.headline3,
      //         headline4: data.headline4,
      //         ctaText: data.CTA,
      //         impressionTracker: "../../../../1x1.png?impressionTracker=" + Math.random(),
      //         clickTracker: "../../../../1x1.png?clickTracker=" + Math.random(),
      //         clickUrl: "https://office.com/",
      //       }`,
      //       'Template 4': `var cam = {
      //         layout: data.Layout,
      //         headline1: data.headline1,
      //         headline2: data.headline2,
      //         ctaText: data.CTA,
      //         impressionTracker: "../../../../1x1.png?impressionTracker=" + Math.random(),
      //         clickTracker: "../../../../1x1.png?clickTracker=" + Math.random(),
      //         clickUrl: "https://office.com/",
      //       }`,
      //     }
      //     eval(templates[data['template']]);
      //     return JSON.stringify(cam);
      // }
      var loadContent = function(queryString){
        bannerData = [];
        bannerData1 = [];
        var htmlContent = '';



        htmlContent = '';
        // var queryString = 'Japan|Create_O365_Word_Inking';
        var adContent = getData(queryString);
        var adSize = adContent.selectedAd;
        var adWidth = adSize.split('x')[0];
        var adHeight = adSize.split('x')[1];
        amo.attributes = {};
        var creativePath = 'ads/' + adContent.data[0]['Smart Names'] + '/' + adSize + '/' + adSize + '.html';
        var creativeFrames = frames[creativePath];
        var framesHTML = '';
        if(Object.keys(creativeFrames).length > 1) {
          for(var i in creativeFrames) {
            framesHTML += '<div class="frame-wrapper" id="ad' + adSize + '"><iframe src="' + creativeFrames[i] + '?v=' + publishVersion + '" width="' + adWidth + '" height="' + adHeight + '"></iframe></div>';
          }
        }
        document.querySelector('#adContainer').innerHTML = //'<div class="frame-wrapper"><iframe src="160x600/160x600.html" width="160" height="600" scrolling="no" frameborder="0" allowtransparency="true" hspace="0" vspace="0" marginwidth="0" marginheight="0"></iframe><div>160 x 600</div></div>'+
        // '<div class="frame-wrapper"><iframe src="300x600/300x600.html" width="300" height="600" scrolling="no" frameborder="0" allowtransparency="true" hspace="0" vspace="0" marginwidth="0" marginheight="0"></iframe><div>300 x 600 Portrait</div></div>'+
        '<div class="frame-wrapper" id="ad160x600"></div>'+
        '<div class="frame-wrapper" id="ad300x600"></div>'+
        // '<div class="frame-wrapper"><iframe src="300x600(OnFigure)/300x600.html" width="300" height="600" scrolling="no" frameborder="0" allowtransparency="true" hspace="0" vspace="0" marginwidth="0" marginheight="0"></iframe><div>300 x 600 Full Body</div></div>'+
        '<div style="display:inline-block;max-width:800px;text-align:left;">'+
          // '<div class="frame-wrapper"><iframe src="300x250/300x250.html" width="300" height="250" style="display:block;" scrolling="no" frameborder="0" al"lowtransparency="true" hspace="0" vspace="0" marginwidth="0" marginheight="0"></iframe><div>300 x 250</div></div>'+
          '<div class="frame-wrapper" id="ad' + adSize + '"><iframe src="' + creativePath + '?v=' + publishVersion + '" width="' + adWidth + '" height="' + adHeight + '"></iframe></div>'+
          // '<div class="frame-wrapper" id="ad300x250"><iframe src="ads/' + adContent.data[0]['Smart Names'] + '/300x250/300x250.html' + '" width="300" height="250"></iframe></div>'+
        //   '<div></div>'+
        //   '<div class="frame-wrapper"><iframe src="320x50/320x50.html" width="320" height="50" style="display:block;" scrolling="no" frameborder="0" allowtransparency="true" hspace="0" vspace="0" marginwidth="0" marginheight="0"></iframe><div>320 x 50</div></div>'+
          // '<div class="frame-wrapper"><iframe src="728x90/728x90.html" width="728" height="90" style="display:block;" scrolling="no" frameborder="0" allowtransparency="true" hspace="0" vspace="0" marginwidth="0" marginheight="0"></iframe><div>728 x 90</div></div>'+
          '<div class="frame-wrapper" id="ad728x90"></div>'+
        '</div>'+
        (framesHTML.length ? '<div>'+
          '<div class="frame-title">Frames</div>'+
          framesHTML+
        '</div>' : '')+
        // '<div class="frame-wrapper"><iframe src="970x250/970x250.html" width="970" height="250" scrolling="no" frameborder="0" allowtransparency="true" hspace="0" vspace="0" marginwidth="0" marginheight="0"></iframe><div>970 x 250</div></div>';
        '';
        var group = adContent.data[0].Group;
        var smartName = adContent.name;
        location.hash = btoa(group+'|'+smartName+'|'+adSize).replace('==','');
        htmlContent += adData.map(function(data){ return '<div '+(group == data.name ? 'class="selected"' : '')+' data-id="' + data.name + '">' + data.name.split(' ')[0] + '<div style="font-size:14px;">' + data.name.split(' ')[1] + '</div></div>' }).join('');
        document.querySelector('#header').innerHTML = htmlContent;
        htmlContent = '';
        var groupData = adData.find(function(data){ return data.name == group; });
        if(groupData) {
          htmlContent += groupData.data.map(function(data){ return '<div '+(smartName == data.name ? 'class="selected"' : '')+' data-id="' + groupData.name + '|' + data.name + '" title="' + groupData.name + ' > ' + data.name + '">'+ data.name + '</div>' }).join('');
        }
        document.querySelector('#subheader').innerHTML = htmlContent;
        htmlContent = '';
        htmlContent += adContent.data[0].ads.map(function(ad){ return '<div '+(adSize == ad ? 'class="selected"' : '')+' data-id="' + groupData.name + '|' + adContent.name + '|' + ad + '" title="' + groupData.name + ' > ' + adContent.name + ' > ' + ad + '">'+ ad + '</div>' }).join('');
        document.querySelector('#subsubheader').innerHTML = htmlContent;
        htmlContent = '';
        htmlContent = adContent.data[0].Group + ' | ' + adContent.name + ' | ' + adSize;
        document.querySelector('#title').innerHTML = htmlContent;
        var headers = document.querySelectorAll('#header > div');
        for(var i = 0; i < headers.length; i++) {
            headers[i].onclick = function() {
              loadContent(this.dataset.id);
            }
        }
        var subheaders = document.querySelectorAll('#subheader > div');
        for(var i = 0; i < subheaders.length; i++) {
            subheaders[i].onclick = function() {
              loadContent(this.dataset.id);
            }
        }

        var subheaders = document.querySelectorAll('#subsubheader > div');
        for(var i = 0; i < subheaders.length; i++) {
            subheaders[i].onclick = function() {
              loadContent(this.dataset.id);
            }
        }

        // adContent.data.map(function(data){
        //   var adSize = data['Ad Size'];
        //   var adWidth = adSize.split('x')[0];
        //   var adHeight = adSize.split('x')[1];
        //   var template = data.template.split(' ').join('');
        //   var cam = getCAMData(data);
        //   var adScript = `
        //   var cam = ${cam}
        //   for(var i in cam) { amo.registerVariation(i, cam[i]); }
        //   amo.registerVariation = function(){}`;
        //   var amoScript = document.createElement('script');
        //   amoScript.type= 'text/javascript';
        //   amoScript.src = "js/AMOLibrary.js";
        //   var scriptTag = document.createElement('script');
        //   scriptTag.type= 'text/javascript';
        //   var inlineScript = document.createTextNode(adScript);
        //   scriptTag.appendChild(inlineScript);
        //   var iframe = document.createElement('iframe');
        //   iframe.id = adSize;
        //   iframe.style.width = adWidth + 'px';
        //   iframe.style.height = adHeight + 'px';
        //   iframe.style.border = 'none';
        //   document.querySelector('#ad' + adSize).innerHTML = '';
        //   document.querySelector('#ad' + adSize).appendChild(iframe);
        //   var iframeDoc = iframe.contentWindow ? iframe.contentWindow : iframe.contentDocument && iframe.contentDocument.document ? iframe.contentDocument.document : iframe.contentDocument;
        // 	iframeDoc.document.open();
        //   iframeDoc.document.write('<iframe src="ads/'+template+'/Ads/'+adSize+'/z'+adSize+'.html" width="'+adWidth+'" height="'+adHeight+'" style="display:block;" scrolling="no" frameborder="0" allowtransparency="true" hspace="0" vspace="0" marginwidth="0" marginheight="0"></iframe>');
        // 	iframeDoc.document.close();
        //   iframeDoc.document.body.style.margin = 0;
        //   iframeDoc.document.head.appendChild(amoScript);
        //   amoScript.onload = function(){
        //     iframeDoc.document.head.appendChild(scriptTag);
        //   }
        // });
        checkFooter();
      }
      var loadPage = function(){
        var searchFlag = false;
        if(location.hash && location.hash.length) {
          var selector = location.hash.split('#')[1];
          loadContent(selector ? atob(selector) : 'OPT General');
        } else { loadContent('OPT General'); }
      }
      // window.getBannerData = function(k){
      //   var obj = {};
      //   for(var j in bannerData) {
      //     if(bannerData[j].adSize == k) { for(var i in bannerData[j]) { obj[i] = bannerData[j][i]; } }
      //   }
      //   return obj;
      // }
      // window.getBannerData1 = function(){ var obj = {}; for(var i in bannerData1[0]) { obj[i] = bannerData1[0][i]; } return obj; }
    </script>
  </body>
</html>
