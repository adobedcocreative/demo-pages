<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <link rel="icon" href="https://www.adobe.com/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="https://www.adobe.com/favicon.ico" type="image/x-icon">
    <title>Adobe: Advertising Preview Page</title>
    <style media="screen">
      body {
        min-width: 1024px;
        margin-bottom: 0px;
      }
      .ad-wrapper {
        /* max-width: 970px; */
        margin: 0 auto;
        text-align: center;
      }
      #headerContainer, #header, #subheader{
        text-align: center;
      }
      #header .image-container {
        display: inline-block;
        position: relative;
      }
      #header .image {
        position: relative;
        display: inline-block;
        width: 50px;
        height: 40px;
      }
      #header .image:first-child {
        position: absolute;
        top:0px;
        left:0px;
      }
      #header .image img {
        max-width: 100%;
        max-height: 100%;
      }

      #header > div {
        font-family: Arial;
        display: inline-block;
        /* min-height: 65px; */
        vertical-align: top;
        padding: 10px 5px 2px 5px;
        margin: 0px 5px 2px 5px;
        color:#333;
        text-align: center;
        /* -webkit-transition: all ease-out 0.2s;
        transition: all ease-out 0.2s; */
        cursor: pointer;
      }
      #header > div:hover {
        margin: 0px;
        margin: 0px 5px 0px 5px;
        border-bottom: 2px solid;
        color:#0084d6;
      }
      #header > div.selected {
        margin: 0px;
        margin: 0px 5px 0px 5px;
        border-bottom: 2px solid;
        color:#0084d6;
      }
      #subheader {
        display: inline-block;
        margin: 0 20px;
        background-color: rgba(0,0,0,0.1);
      }
      #subheader > div {
        font-family: Arial;
        display: inline-block;
        /* min-height: 65px; */
        vertical-align: top;
        font-size: 12px;
        padding: 10px 5px 2px 5px;
        margin: 0px 5px 8px 5px;
        color:#333;
        text-align: center;
        /* -webkit-transition: all ease-out 0.2s;
        transition: all ease-out 0.2s; */
        cursor: pointer;
      }
      #subheader > div:hover {
        /* margin: 0px;
        margin: 0px 5px 0px 5px;
        border-bottom: 2px solid; */
        color:#0084d6;
      }
      #subheader > div.selected {
        /* margin: 0px;
        margin: 0px 5px 0px 5px;
        border-bottom: 2px solid; */
        color:#0084d6;
      }
      #subsubheader {
        /* display: inline-block; */
        margin: 10px 20px 0;
        /* background-color: rgba(0,0,0,0.1); */
      }
      #subsubheader > div {
        font-family: Arial;
        display: inline-block;
        /* min-height: 65px; */
        vertical-align: top;
        font-size: 14px;
        padding: 2px 7px;
        margin: 0px 5px;
        color:#333;
        border: 1px solid;
        border-radius: 15px;
        text-align: center;
        /* -webkit-transition: all ease-out 0.2s;
        transition: all ease-out 0.2s; */
        cursor: pointer;
      }
      #subsubheader > div:hover {
        /* margin: 0px;
        margin: 0px 5px 0px 5px;
        border-bottom: 2px solid; */
        color:#0084d6;
        border-bottom: 2px solid;
      }
      #subsubheader > div.selected {
        /* margin: 0px;
        margin: 0px 5px 0px 5px;
        border-bottom: 2px solid; */
        color:#0084d6;
        border-bottom: 2px solid;
      }
      #title {
        font-family: Arial;
        /* display: inline-block; */
        vertical-align: top;
        padding: 10px 5px 2px 5px;
        margin: 0px 5px 2px 5px;
        color:#333;
        font-size: 20px;
        text-align: center;
        color:#0084d6;
      }
      .frame-title{
        font-family: Arial;
        /* display: inline-block; */
        vertical-align: top;
        padding: 10px 5px 2px 5px;
        margin: 0px 5px 2px 5px;
        color:#333;
        font-size: 20px;
        text-align: center;
        color:#0084d6;
        margin-top: 10px;
        border-bottom: 1px solid #0084d6;
      }
      .frame-wrapper {
        display: inline-block;
      }
      .frame-wrapper div {
        font-family: Arial;
        text-align: left;
        margin-left: 10px;
      }
      iframe {
        border: none;
        margin: 10px 10px 2px 10px;
      }
      @font-face {
        font-family:"adobe-clean";
        src:url("fonts/adobe-clean-700.woff2") format("woff2"),
          url("fonts/adobe-clean-700.woff") format("woff"),
          url("fonts/adobe-clean-700.otf") format("opentype");
        font-display:auto;font-style:normal;font-weight:700;
      }
      footer {
        position: fixed;
        left: 0;
        bottom: 0;
        right: 0;
        background: #fff;
        font-family:adobe-clean,Source Sans Pro,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;
        font-weight: 700;
        color: #4B4B4B;
        border-top: solid 1px #999999;
        display: flex;
        justify-content: center;/*space-between;*/
        padding: 6px 10px 8px;
        margin: 20px 20px 0px;
      }
      .adobe-red { color: #FA0F00; }
    </style>
    <script src="js/AMOLibrary.js" charset="utf-8"></script>
    <script src="js/content.js" charset="utf-8"></script>
    <script src="frames.js" charset="utf-8"></script>
  </head>
  <body onload="init()">
    <div id="headerContainer">
      <div id="header" class=""></div>
      <div id="subheader" class=""></div>
      <div id="subsubheader" class=""></div>
      <div id="title" class=""></div>
    </div>
    <div id="adContainer" class="ad-wrapper">
      <div id="mainAd"></div>
      <div id="adFrames"></div>
    </div>
    <footer>
      <!-- <div style="font-size: 14px;">Content: <a id="contentLink" href="https://adobe.com" target="_blank" style="text-decoration:none;"><img src="images/sheets-icon.svg" style="height: 14px;margin: 0px 4px;vertical-align:-5%;" /></a></div> -->
      <div style="font-size: 14px;">Developed by: <a href="https://adobe.com" target="_blank" style="text-decoration:none;"><img src="images/Adobe_Corporate_Horizontal_Red_HEX.svg" style="width: 14px;margin: 0px 4px;vertical-align:-5%;" /><font class="adobe-red" style="font-size:14px;">Adobe</font></a></div>
    </footer>
    <script type="text/javascript">
      function init() {
        // document.querySelector('#contentLink').href = "https://docs.google.com/spreadsheets/d/" + sheetID.split('/')[0];
      }
      var checkFooter = function() {
        var bodyHeight = document.body.offsetHeight;
        var footer = document.querySelector('footer');
        if(window.innerHeight > bodyHeight) {
          footer.style.position = 'fixed';
          document.body.style.paddingBottom = '30px';
        } else {
          footer.style.position = 'static';
          document.body.style.paddingBottom = '0px';
        }
      }
      checkFooter();
      window.onresize = checkFooter;
      var loadContent = function(queryString){
        var htmlContent = '';
        var adContent = getData(queryString);
        var adSize = adContent.selectedAd;
        var adWidth = adSize.split('x')[0];
        var adHeight = adSize.split('x')[1];
        amo.attributes = {};
        var creativePath = `ads/${adContent.data[0]['Smart Names']}/${adSize}/${adSize}.html`;
        document.querySelector('#mainAd').innerHTML = '<div class="frame-wrapper" id="ad' + adSize + '"><iframe src="' + creativePath + '?v=' + publishVersion + '" width="' + adWidth + '" height="' + adHeight + '"></iframe></div>';
        document.querySelector('#adFrames').innerHTML = '';
        window.addFrames = (frameCount) => {
          if(frameCount) {
            document.querySelector('#adFrames').innerHTML = '<div class="frame-title">Frames</div>' + [...Array(frameCount)].map((x, i)=> `<div class="frame-wrapper"><iframe src="${creativePath}?#${i+1}" width="${adWidth}" height="${adHeight}"></iframe></div>`).join('');
            checkFooter();
          }
        }
        var group = adContent.data[0].Group;
        var smartName = adContent.name;
        location.hash = btoa(group+'|'+smartName+'|'+adSize).replace('==','');
        // adNavigation(document.querySelector('#header'), adData, group, );
        var navElement1 = document.querySelector('#header');
        navElement1.innerHTML = '';
        adData.forEach(data => {
          var div = document.createElement('div');
          div.dataset.id = data.name;
          if(group === data.name) div.classList.add('selected');
          div.onclick = (e) => loadContent(e.target.dataset.id);
          div.innerHTML = data.name.split(' ')[0] + '<div style="font-size:14px;">' + data.name.split(' ')[1] + '</div>';
          navElement1.appendChild(div);
        });
        var groupData = adData.find(function(data){ return data.name == group; });
        var navElement2 = document.querySelector('#subheader');
        navElement2.innerHTML = '';
        groupData.data.forEach(data => {
          var div = document.createElement('div');
          div.dataset.id = groupData.name + '|' + data.name;
          div.dataset.title = groupData.name + ' > ' + data.name;
          if(smartName === data.name) div.classList.add('selected');
          div.onclick = (e) => loadContent(e.target.dataset.id);
          div.innerHTML = data.name;
          navElement2.appendChild(div);
        });
        var navElement3 = document.querySelector('#subsubheader');
        navElement3.innerHTML = '';
        adContent.data[0].ads.forEach(ad => {
          var div = document.createElement('div');
          div.dataset.id = groupData.name + '|' + adContent.name + '|' + ad;
          div.dataset.title = groupData.name + ' > ' + adContent.name + ' > ' + ad;
          if(adSize === ad) div.classList.add('selected');
          div.onclick = (e) => loadContent(e.target.dataset.id);
          div.innerHTML = ad;
          navElement3.appendChild(div);
        });
        document.querySelector('#title').innerHTML = adContent.data[0].Group + ' | ' + adContent.name + ' | ' + adSize;;
        checkFooter();
      }
      const loadPage = () => loadContent(location.hash && location.hash.length && location.hash.split('#')[1] ? atob(location.hash.split('#')[1]) : 'OPT General');
    </script>
  </body>
</html>
